<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Firebase DB Input Form</title>
        <link rel="stylesheet" href="./style.css">
    </head>

    <body>
        <main>
            <form id="vidFormInput">
                <fieldset>

                    <!-- inputs for the form -->
                    <label>Username:</label>
                    <input type="text" name="username" id="user"><br>

                    <label>Video Title:</label>
                    <input type="text" name="vidTitle" id="title"><br>

                    <label>Author or Channel Name:</label>
                    <input type="text" name="authorChannelName" id="authChName"><br>

                    <label>Video Link:</label>
                    <input type="url" name="vidLink" id="link"><br>

                    <label>Number of Views:</label>
                    <input type="number" name="numOfViews" id="views"><br>

                    
                    <label>Category:</label>
                    <select name="category" id="cat">
                        <option value="" selected disabled hidden>pick one!</option>
                        <optgroup label="Home">
                            <option>Repair</option>
                            <option>Gadgets</option>
                            <option>Cleaning</option>
                        </optgroup>
                        <optgroup label="Personal">
                            <option>Personal Growth</option>
                            <option>Appointments</option>
                            <option>Cooking</option>
                        </optgroup>
                    </select>
                    <br>
                    <br>

                    <button id="addToDB" class="btn waves-effect waves-light">Add to DB</button>
                
                </fieldset>
            </form>
        </main>
            
        
        <section>
            <script type="module">
                // Import the functions you need from the SDKs you need
                import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-app.js";
                import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-analytics.js";
                import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-database.js";
                
                // TODO: Add SDKs for Firebase products that you want to use
                // https://firebase.google.com/docs/web/setup#available-libraries
                
                // Your web app's Firebase configuration
                // For Firebase JS SDK v7.20.0 and later, measurementId is optional
                const firebaseConfig = {
                    apiKey: "AIzaSyCrknIUPr7hgnqpxJxmgYwdIJbjHNfppGs",
                    authDomain: "how-to-adult-a4e2d.firebaseapp.com",
                    projectId: "how-to-adult-a4e2d",
                    storageBucket: "how-to-adult-a4e2d.appspot.com",
                    messagingSenderId: "543048609168",
                    appId: "1:543048609168:web:6c55cd0eeffe3ef3091715",
                    measurementId: "G-Z8421SBX0E"
                };
                
                // Initialize Firebase APP with DB
                const app = initializeApp(firebaseConfig);
                const analytics = getAnalytics(app);
                const db = getDatabase(app);

                //event listener that is triggered after button is clicked 
                document.getElementById('addToDB').addEventListener('click', (e) => {
                    e.preventDefault();

                    //grabs the values in each field and assigns it to vars in DB
                    set(ref(db, 'videos/' + Math.random().toString(36).slice(2, 7)), {
                        username: document.getElementById('user').value,
                        videoTitle: document.getElementById('title').value,
                        authorChannelName: document.getElementById('authChName').value,
                        videoLink: document.getElementById('link').value,
                        numOfViews: document.getElementById('views').value,
                        category: document.getElementById('cat').value
                    });

                    //confirmation that form was submitted
                    alert('you submitted a video!');
                    //resets form after one submission
                    document.getElementById('vidFormInput').reset();
                });

            </script>
        </section>
    </body>
</html>