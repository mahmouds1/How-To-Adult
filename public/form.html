<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Firebase DB Input Form</title>
        <link rel="stylesheet" href="./formStyle.css?{% now 'U' %}">
    </head>

    <body>

        <div class="bg"></div>
        <div class="bg bg2"></div>
        <div class="bg bg3"></div>
        </div>  

        <header>
            <a href="./index.html">
                <h1 class='title_hta'>HOW TO ADULT</h1>
            </a>
        
            <nav id="topBar">
                <ul>
                    <li><a href="./form.html">Forms</a></li>
                    <li class="dropdown">
                        <a href="javascript:void(0)" class="dropdownBtn">Categories</a>
                        <div class="wrapper">
                            <div class="dropdown-content">
                                <label>Home</label>
                                <a href="./home-categories/homeRepair.html">Repair</a>
                                <a href="./home-categories/homeCleaning.html">Cleaning</a>
                                <a href="./home-categories/homeGadgets.html">Gadgets</a>
                            </div>
                            <div class="dropdown-content">
                                <label>Personal</label>
                                <a href="./personalGrowth.html">Growth</a>
                                <a href="./personalAppointments.html">Appointments</a>
                                <a href="./personalCooking.html">Cooking</a>
                                <a href="./personalTravel.html">Travel</a>
                            </div>
                        </div>
                    </li>
                </ul>
            </nav>
        </header>
        
        <div id ="resource" style="margin-left:auto; margin-right:auto; width:400px">
            <form id="resourceFormInput">
                <fieldset >

                    <!-- inputs for the form -->
                    <div style="display:block;">
                        <label>Email:</label>
                        <input style="float:right;" type="email" name="email" id="email"><br>
                    </div>

                    <br>

                    <div style="display:block;">
                        <label>Resource Title:</label>
                        <input style="float:right;" type="text" name="ReTitle" id="title"><br>
                    </div>

                    <br>

                    <div style="display:block;">
                        <label>Author or Channel Name:</label>
                        <input style="float:right;" type="text" name="authorChannelName" id="authChName"><br>
                    </div>  

                    <br>

                    <div style="display:block;">
                        <label>Resource Link:</label>
                        <input style="float:right;" type="url" name="ReLink" id="link"><br>
                    </div>
                    
                    <br>

                    <div style="display:block;">
                        <label>Category:</label>
                        <select style="float:right;"name="category" id="cat">
                            <option value="" selected disabled hidden>Pick one!</option>
                            <optgroup label="Home">
                                <option>Repair</option>
                                <option>Gadgets</option>
                                <option>Cleaning</option>
                            </optgroup>
                            <optgroup label="Personal">
                                <option>Personal Growth</option>
                                <option>Appointments</option>
                                <option>Cooking</option>
                            </optgroup>
                        </select>
                    </div>

                    <br>

                    <button id="addRe" class="btn waves-effect waves-light">Submit Resource</button>
                
                </fieldset>
            </form>
        </div>
            
        <div id ="suggestion" style="margin-left:auto; margin-right:auto; width:400px">
                    <form id="suggestionFormInput">
                        <fieldset>

                            <!-- inputs for the form -->
                            <div style="display:block;">
                                <label>Email:</label>
                                <input style="float:right;" type="email" name="email" id="email"><br>
                            </div>
                            <br>

                            <div style="display:block;">
                                <label>what resource type would you prefer?</label>
                                <input style="float:right;" type="radio" name="reType" value="video">Video
                                <input style="float:right;" type="radio" name="reType" value="article"> Article<br>
                            </div>

                            <br>

                            <div style="display:block;">
                                <label>Resource question you want an answer for?</label>
                                <input style="float:right;" type="text" name="question" id="q">
                            </div>

                            <br>

                            <button id="addSugg" class="btn waves-effect waves-light">Submit Suggestion</button>
                        
                        </fieldset>
                    </form>
                </div>

        <section id="dbCode">
            <script type="module">

                // Import the functions you need from the SDKs you need
                import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-app.js";
                import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-analytics.js";
                import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-database.js";
                // TODO: Add SDKs for Firebase products that you want to use
                // https://firebase.google.com/docs/web/setup#available-libraries

                // Your web app's Firebase configuration
                // For Firebase JS SDK v7.20.0 and later, measurementId is optional
                const firebaseConfig = {
                    apiKey: "AIzaSyA_selFhau1MjqN25KPf-sgMgnhH4pguBk",
                    authDomain: "how-to-adultv3.firebaseapp.com",
                    databaseURL: "https://how-to-adultv3-default-rtdb.firebaseio.com",
                    projectId: "how-to-adultv3",
                    storageBucket: "how-to-adultv3.appspot.com",
                    messagingSenderId: "775755015579",
                    appId: "1:775755015579:web:0e0b7a25d9a7f8eaa16d3e",
                    measurementId: "G-YM8W5FNFRW"
                };

                // Initialize Firebase APP with DB
                const app = initializeApp(firebaseConfig);
                const analytics = getAnalytics(app);

                //db set-up
                const db = getDatabase(app);

                //event listener that is triggered after 'Submit Resource' button is clicked 
                document.getElementById('addRe').addEventListener('click', (e) => {
                    e.preventDefault();
                    //grabs the values in each field and assigns it to vars in DB
                    set(ref(db, 'resources/' + Math.random().toString(36).slice(2, 7)), {
                        email: document.getElementById('email').value,
                        resourceTitle: document.getElementById('title').value,
                        authorChannelName: document.getElementById('authChName').value,
                        resourceLink: document.getElementById('link').value,
                        category: document.getElementById('cat').value
                    });

                    //confirmation that form was submitted
                    alert('you submitted a resource!');
                    //resets form after one submission
                    document.getElementById('resourceFormInput').reset();
                });



                //event listener that is triggered after 'Submit Suggestion' button is clicked 
                    document.getElementById('addSugg').addEventListener('click', (e) => {
                        e.preventDefault();

                        //grabs the values in each field and assigns it to vars in DB
                        set(ref(db, 'suggestions/' + Math.random().toString(36).slice(2, 7)), {
                            email: document.getElementById('email').value,
                            resourceType: document.querySelector('input[name="reType"]:checked').value,
                            resourceQ: document.getElementById('q').value,
                        });

                        //confirmation that form was submitted
                        alert('you submitted a suggestion!');
                        //resets form after one submission
                        document.getElementById('suggestionFormInput').reset();
                    });


            </script>
        </section>
    </body>
</html>