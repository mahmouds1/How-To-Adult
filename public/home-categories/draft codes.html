<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Firebase DB Input Form</title>
        <link rel="stylesheet" href="./catHDesign.css">
    </head>

    <body>
        <header>
            <a href="./../index.html">
                <h1>HOW TO ADULT</h1>
            </a>
        
            <nav id="topBar">
                <ul>
                    <li><a href="./../form.html">Forms</a></li>
                    <li class="dropdown">
                        <a href="javascript:void(0)" class="dropbtn">Categories</a>
                        <div class="wrapper">
                            <div class="dropdown-content">
                                <label>Home</label>
                                <a href="./homeRepair.html">Repair</a>
                                <a href="./homeCleaning.html">Cleaning</a>
                                <a href="./homeGadgets.html">Gadgets</a>
                            </div>
                            <div class="dropdown-content">
                                <label>Personal</label>
                                <a href="./personalGrowth.html">Growth</a>
                                <a href="./personalAppointments.html">Appointments</a>
                                <a href="./personalCooking.html">Cooking</a>
                                <a href="./personalTravel.html">Travel</a>
                            </div>
                        </div>
                    </li>
                </ul>
            </nav>
        </header>


        <h1>this is homeRepair category</h1>



        <div class = "grid-container">
            <div class="grid-item" id="resource1">
                <div class="class-container">
                    <h4 id="r1-titleLink"><b>[title here]</b></h4>
                    <p id="r1-authCh">details here pt2</p>
                    <p id="r1-views">details here pt3</p>
                </div>
            </div>
            
            <div class="grid-item" id="resource2">
                <div class="class-container">
                    <h4 id="r2-titleLink"><b>[title here]</b></h4>
                    <p id="r2-authCh">details here pt2</p>
                    <p id="r2-views">details here pt3</p>
                </div>

            </div>

            <div class="grid-item" id="resource3">
                <div class="class-container">
                    <h4 id="r3-titleLink"><b>[title here]</b></h4>
                    <p id="r3-authCh">details here pt2</p>
                    <p id="r3-views">details here pt3</p>
                </div>

            </div>

            <div class="grid-item" id="resource4">
                <div class="class-container">
                    <h4 id="r4-titleLink"><b>[title here]</b></h4>
                    <p id="r4-authCh">details here pt2</p>
                    <p id="r4-views">details here pt3</p>
                </div>

            </div>


            <div class="grid-item" id="resource5">
                <div class="class-container">
                    <h4 id="r5-titleLink"><b>[title here]</b></h4>
                    <p id="r5-authCh">details here pt2</p>
                    <p id="r5-views">details here pt3</p>
                </div>

            </div>

            <div class="grid-item" id="resource6">
                <div class="class-container">
                    <h4 id="r6-titleLink"><b>[title here]</b></h4>
                    <p id="r6-authCh">details here pt2</p>
                    <p id="r6-views">details here pt3</p>
                </div>

            </div>

            <div class="grid-item" id="resource7">
                    <div class="class-container">
                    <h4 id="r7-titleLink"><b>[title here]</b></h4>
                    <p id="r7-authCh">details here pt2</p>
                    <p id="r7-views">details here pt3</p>
                </div>

            </div>

            <div class="grid-item" id="resource8">
                <div class="class-container">
                    <h4 id="r8-titleLink"><b>[title here]</b></h4>
                    <p id="r8-authCh">details here pt2</p>
                    <p id="r8-views">details here pt3</p>
                </div>

            </div>

            <div class="grid-item" id="resource9">
                <div class="class-container">
                    <h4 id="r9-titleLink"><b>[title here]</b></h4>
                    <p id="r9-authCh">details here pt2</p>
                    <p id="r9-views">details here pt3</p>
                </div>

            </div>
        </div>



       
        <section id="dbCode">
            <script type="module">

                /*init firebase app*/
                // Import the functions you need from the SDKs you need
                import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-app.js";
                import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-analytics.js";
                import { getDatabase, ref, set, get, child, onValue} from "https://www.gstatic.com/firebasejs/9.8.1/firebase-database.js";
                // TODO: Add SDKs for Firebase products that you want to use
                // https://firebase.google.com/docs/web/setup#available-libraries

                // Your web app's Firebase configuration
                // For Firebase JS SDK v7.20.0 and later, measurementId is optional
                const firebaseConfig = {
                    apiKey: "AIzaSyA_selFhau1MjqN25KPf-sgMgnhH4pguBk",
                    authDomain: "how-to-adultv3.firebaseapp.com",
                    databaseURL: "https://how-to-adultv3-default-rtdb.firebaseio.com",
                    projectId: "how-to-adultv3",
                    storageBucket: "how-to-adultv3.appspot.com",
                    messagingSenderId: "775755015579",
                    appId: "1:775755015579:web:0e0b7a25d9a7f8eaa16d3e",
                    measurementId: "G-YM8W5FNFRW"
                };
                

                // Initialize Firebase APP with DB
                const app = initializeApp(firebaseConfig);
                const analytics = getAnalytics(app);

                //db set-up
                const db = getDatabase(app);
                const dbRef = ref(getDatabase(app));
                //var id = "h-r-001";
                var i = 1;

                //grabbing specific values depending on id
                /*
                var idPre = "h-r-";
                var idNum = 1;
                var i=1;

                var idSearch = idPre + Integer.toString(idNum);

                for(i = 1;i<10;i++){

                }*/




                //attempt 6
                var idCat = "h-r-";
                var idNum = 1;
                var data;

                for (let i = 1; i <= 9; i++) {
                    const titleRef = ref(db, 'displyed-resources/titles/' + idCat + idNum);
                    const linkRef = ref(db, 'displyed-resources/links/' + idCat + idNum);
                    const authChRef = ref(db, 'displyed-resources/auth-channels/' + idCat + idNum);
                    const viewRef = ref(db, 'displyed-resources/views/' + idCat + idNum);

                    onValue(titleRef, (snapshot) => {
                         onValue(linkRef, (snapshot2) => {
                            
                            console.log("title: ", snapshot.val());
                            console.log("link: ", snapshot2.val());
                            document.querySelector('#r' + i + '-titleLink').innerHTML = `<h4><a href="${snapshot2.val()}">${snapshot.val()}</a></h4>`;
                        });

                    });

                    onValue(authChRef, (snapshot3) => {
                        data = snapshot3.val();
                        console.log(data);
                        document.querySelector('#r' + i + '-authCh').innerHTML = `<p>${data}</p>`;
                    }); //end of onValue(authCh)

                    
                    onValue(viewRef, (snapshot4) => {
                        data = snapshot4.val();
                        console.log(data);
                        document.querySelector('#r' + i + '-views').innerHTML = `<p>${data}</p>`;
                    }); //end of onValue(view)

                    idNum++;
                }

 

                //attempt 4




                /*works!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
               //attempt 5

                var idCat = "hr";
                var idType = ["L", "T", "A"];
                var idNum = 1;
                var data;

                for(let i =1; i<=9;i++){
                    const titleRef = ref(db, 'displayed-resources/' + idCat + idType[1]+ idNum);
                    const linkRef = ref(db, 'displayed-resources/' + idCat + idType[0] + idNum);
                    const authChRef = ref(db, 'displayed-resources/' + idCat + idType[2] + idNum);

                    onValue(titleRef, (snapshot) => {
                        data = snapshot.val();
                        console.log(data);
                        document.querySelector('#r' + i + '-titleLink').innerHTML = `<h4>${data}</h4>`;
                        //document.querySelector('#r' + i + '-authCh').innerHTML = `<p>${snapshot3.val()}</p>`;
                        //document.querySelector('#r' + i + '-views').innerHTML = `<p>${snapshot4.val()}</p>`;
                    });

                    onValue(linkRef, (snapshot2)=>{
                         data = snapshot2.val();
                        console.log(data);
                       document.querySelector('#r' + i + '-authCh').innerHTML = `<a href="${data}">Resource Link</a>`;
                    })

                    onValue(authChRef, (snapshot3) => {
                        data = snapshot3.val();
                        console.log(data);
                        document.querySelector('#r' + i + '-views').innerHTML = `<p>${data}</p>`;
                    })

                    idNum++;
                }



                */

                /** forEach and separate get vars but didnt work

               var getData =  get(child(dbRef, `displyed-resources/titles/${id}`)).then(snapshot1);
                var getData2 = get(child(dbRef, `displyed-resources/links/${id}`)).then(snapshot2);
                var getData3 =  get(child(dbRef, `displyed-resources/auth-channels/${id}`)).then(snapshot2);
                var getData4 = get(child(dbRef, `displyed-resources/views/${id}`)).then(snapshot2);

                console.log("pre getting",i);


                //get data and display it
                if (getData.exists() || getData2.exists() || getData3.exists() || getData4.exists()) {
                            snapshot1.forEach(function (element) {
                                snapshot2.forEach(function(element2){
                                    snapshot3.forEach(function(element3){
                                        snapshot4.forEach(function(element4){
                                            console.log("inside for eaches", i);
                                            //used for testing
                                            console.log(snapshot1.val());
                                            console.log(snapshot2.val());
                                            console.log(snapshot3.val());
                                            console.log(snapshot4.val());

                                            //displaying data through inline html
                                            document.querySelector('#r' + i + '-titleLink').innerHTML = `<h4><a href="${element2.val()}">${element.val()}</a></h4>`;
                                            document.querySelector('#r' + i + '-authCh').innerHTML = `<p>${element3.val()}</p>`;
                                            document.querySelector('#r' + i + '-views').innerHTML = `<p>${element4.val()}</p>`;
                                            i++;

                                        }) //end element 4
                                    })//end element 3
                                })//end element 2
                            })//end elemet
                } else {
                    console.log("No data available");
                }**/

                /*db reference togeter
                //get data and display it
                    get(child(dbRef, `displyed-resources/titles/${id}`)).then((snapshot1) => {
                        get(child(dbRef, `displyed-resources/links/${id}`)).then((snapshot2) => {
                            get(child(dbRef, `displyed-resources/auth-channels/${id}`)).then((snapshot3) => {
                                get(child(dbRef, `displyed-resources/views/${id}`)).then((snapshot4) => {
                                    if (snapshot1.exists() || snapshot2.exists() || snapshot3.exists() || snapshot4.exists()) {
                                        
                                        console.log(i);
                                        //used for testing
                                        console.log(snapshot1.val()); 
                                        console.log(snapshot2.val());
                                        console.log(snapshot3.val());
                                        console.log(snapshot4.val());

                                        //displaying data through inline html
                                        document.querySelector('#r' + i + '-titleLink').innerHTML = `<h4><a href="${snapshot2.val()}">${snapshot1.val()}</a></h4>`;
                                        document.querySelector('#r' + i + '-authCh').innerHTML = `<p>${snapshot3.val()}</p>`;
                                        document.querySelector('#r' + i + '-views').innerHTML = `<p>${snapshot4.val()}</p>`;

                                    } else {
                                        console.log("No data available");
                                    }
                                });//end of views snapshot (snapshot4)
                            });//end of auth-channels snapshot (snapshot3)
                        });//end of links snapshot (snapshot2)
                    }).catch((error) => {   //end of title snapshot (snapshot1)
                        console.error(error);
                    });


                */

                /** df references individually lmao
                //get links         
                get(child(dbRef, `displyed-resources/links/${id}`)).then((snapshot) => {
                    if (snapshot.exists()) {
                        console.log(snapshot.val());
                        document.querySelector('#r1-titleLink').innerHTML = `<a href="${snapshot.val()}">Resource Link</a>`;
                    } else {
                        console.log("No link data available");
                    }
                }).catch((error) => {
                    console.error(error);
                });

                //get author/channel
                get(child(dbRef, `displyed-resources/auth-channels/${id}`)).then((snapshot) => {
                    if (snapshot.exists()) {
                        console.log(snapshot.val());
                        document.querySelector('#r1-authCh').innerHTML = `<p>${snapshot.val()}</p>`;
                    } else {
                        console.log("No author/channel data available");
                    }
                }).catch((error) => {
                    console.error(error);
                });

                //get views
                get(child(dbRef, `displyed-resources/views/${id}`)).then((snapshot) => {
                    if (snapshot.exists()) {
                        console.log(snapshot.val());
                        document.querySelector('#r1-views').innerHTML = `<p>${snapshot.val()}</p>`;
                    } else {
                        console.log("No views data available");
                    }
                }).catch((error) => {
                    console.error(error);
                });**/

            </script>

            <script>


            </script>
        </section>

    </body>
</html>